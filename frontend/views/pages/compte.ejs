<!DOCTYPE html>
<html lang="fr">

<head>
  <%- include('../partials/head'); %>
</head>

<body>
  <!-- <header> -->
  <%- include('../partials/navbar'); %>
    <!-- </header> -->

    <div class="m-12 flex justify-center items-center text-white">
      <div
        class="p-10 flex flex-col justify-center items-center text-center rounded shadow-2xl backdrop-blur-lg backdrop-saturate-125 bg-black bg-opacity-20 border border-white border-opacity-50">
        <p class="text-4xl text-white">
          <%=prenom%>
            <%=nom%></br>
              <%=statut%></br>
                <%=email%>
        </p>
        <% if (!estAttribue) { %>
          <p class="my-5 text-red-200">Votre compte n'est pas encore validé,</br>veuillez attendre qu'un administrateur
            le valide.</p>
          <% } %>
            <button onClick="ouvrirPopupMail()"
              class="py-2 px-3 mt-10 bg-gray-900 bg-opacity-30 hover:bg-opacity-70 text-white rounded-full transition duration-150">Modifier
              mon e-mail</button>
            <button onClick="ouvrirPopupMDP()"
              class="py-2 px-3 mt-2 bg-gray-900 bg-opacity-30 hover:bg-opacity-70 text-white rounded-full transition duration-150">Modifier
              mon mot de passe</button>
            <% if (estAttribue && statut !="Administrateur" ) { %>
              <button onClick="ouvrirPopupCV()"
                class="py-2 px-3 mt-2 bg-gray-900 bg-opacity-30 hover:bg-opacity-70 text-white rounded-full transition duration-150">Modifier
                CV</button>
              <button onClick="ouvrirPopupLM()"
                class="py-2 px-3 mt-2 bg-gray-900 bg-opacity-30 hover:bg-opacity-70 text-white rounded-full transition duration-150">Modifier
                lettre de motivation</button>
              <button onClick="ouvrirPopupLinkedIn()"
                class="py-2 px-3 mt-2 bg-gray-900 bg-opacity-30 hover:bg-opacity-70 text-white rounded-full transition duration-150">Modifier
                linkedin</button>
              <button onClick="ouvrirOffres()"
                class="py-2 px-3 mt-2 bg-gray-900 bg-opacity-30 hover:bg-opacity-70 text-white rounded-full transition duration-150">Offres
                sauvgardés</button>
              <button onClick="ouvrirSoutenances()"
                class="py-2 px-3 mt-2 bg-gray-900 bg-opacity-30 hover:bg-opacity-70 text-white rounded-full transition duration-150">Dates
                entretiens</button>
              <% } %>

                <button onClick="supprimerCompte()"
                  class="py-2 px-3 mt-10 bg-red-800 bg-opacity-50 hover:bg-opacity-70 text-white rounded-full transition duration-150">Supprimer
                  le compte</button>

                <% if (statut=="Administrateur" && comptes !="" ) { %>
                  <div id="compteAttribuer"
                    class="flex flex-wrap mt-10 p-6 text-white rounded shadow-2xl backdrop-blur-xl bg-black bg-opacity-20 border border-white border-opacity-50">
                    <% comptes.forEach((compte)=> { %>
                      <div
                        class="flex flex-col m-2 py-6 px-8 text-left text-white rounded shadow-2xl backdrop-blur-xl bg-black bg-opacity-20 border border-white border-opacity-50">
                        <h1>Prenom : <%=compte.prenom%>
                        </h1>
                        <h1>Nom : <%=compte.nom%>
                        </h1>
                        <h1>Email : <%=compte.email%>
                        </h1>
                        <h1>Statut : <%=compte.statut%>
                        </h1>
                        <h1>Date : <%= compte.date_inscription.toISOString().substring(0,10) %>
                        </h1>
                        <div id="<%=compte.email%>" class="mt-2 flex justify-evenly">
                          <button onclick="validerAttribution(this)"
                            class="py-1 px-2 bg-green-500 bg-opacity-50 hover:bg-opacity-70 text-white rounded transition duration-150">OK</button>
                          <button onclick="annulerAttribution(this)"
                            class="py-1 px-2 bg-red-500 bg-opacity-50 hover:bg-opacity-70 text-white rounded transition duration-150">ANNULER</button>
                        </div>
                      </div>
                      <% }); %>
                  </div>
                  <% } %>
      </div>
    </div>

    <!-- POPUP CHANGEMENT DE MAIL -->
    <div id="popupMail"
      class="px-16 pt-12 pb-8 absolute top-2/4 left-2/4 transform -translate-x-2/4 -translate-y-2/4 flex flex-col text-center text-white rounded shadow-2xl backdrop-blur-xl bg-black bg-opacity-20 border border-white border-opacity-50"
      style="display: none">
      <form id="formMail" class="flex flex-col">
        <h1 class="text-4xl mb-8">Changement de mail</h1>

        <input type="email"
          class="mt-2 p-3 bg-black bg-opacity-10 rounded focus-within:bg-opacity-40 focus-within:outline-none"
          placeholder="mail@domain.net" id="email" required />

        <div class="mt-12 mb-8 flex justify-around">
          <button
            class="py-1 px-2 bg-green-500 bg-opacity-50 hover:bg-opacity-70 text-white rounded transition duration-150">Envoyer</button>
          <button type="button"
            class="py-1 px-2 bg-red-500 bg-opacity-50 hover:bg-opacity-70 text-white rounded transition duration-150"
            onclick="fermerPopup(this)">Quitter</button>
        </div>
        <span id="messageErreurMail" class="text-red-300 font-bold text-base text-center"></span>
      </form>
    </div>

    <!-- POPUP CHANGEMENT DE MDP -->
    <div id="popupMDP"
      class="px-16 pt-12 pb-8 absolute top-2/4 left-2/4 transform -translate-x-2/4 -translate-y-2/4 flex flex-col text-center text-white rounded shadow-2xl backdrop-blur-xl bg-black bg-opacity-20 border border-white border-opacity-50"
      style="display: none">
      <form id="formMDP" class="flex flex-col">

        <h1 class="text-4xl mb-8">Changement de mot de passe</h1>

        <label for="ancienMDP" class="mt-2 self-start text-base">Ancien mot de passe</label>
        <input type="password" id="ancienMDP" class="mt-2 p-3 bg-black bg-opacity-10 rounded focus-within:bg-opacity-40 focus-within:outline-none" placeholder="Minimum 8 caractères" required min="8" />

        <label for="nouveauMDP" class="mt-6 self-start text-base">Nouveau mot de passe</label>
        <input type="password" id="nouveauMDP" class="mt-2 p-3 bg-black bg-opacity-10 rounded focus-within:bg-opacity-40 focus-within:outline-none" placeholder="Minimum 8 caractères" required min="8" />

        
        <div class="mt-12 mb-8 flex justify-around">
          <button
            class="py-1 px-2 bg-green-500 bg-opacity-50 hover:bg-opacity-70 text-white rounded transition duration-150">Envoyer</button>
          <button type="button"
            class="py-1 px-2 bg-red-500 bg-opacity-50 hover:bg-opacity-70 text-white rounded transition duration-150"
            onclick="fermerPopup(this)">Quitter</button>
        </div>
        <span id="messageErreurMDP" class="text-red-300 font-bold text-base text-center"></span>
      </form>

    </div>

    <!-- POPUP UPLOAD LM -->
    <div id="popupLM" class="bg-black bg-opacity-25 text-white" style="display: none">
      <form id="formLM" class="">
        <h1>Upload lettre de motivation</h1>

        <label for="fileUploadLM"><b>Lettre de motivation</b></label>
        <input type="file" name="fileUploadLM" value="fileUploadLM" id="fileUploadLM">

        <button type="submit" class="btn">Upload</button>
        <button type="button" class="btn cancel" onclick="fermerPopup(this)">Close</button>
      </form>

      <span id="messageErreurLM" class="mt-4 text-red-300 font-bold text-base text-center"></span>
    </div>

    <!-- POPUP CHANGEMENT CV -->
    <div id="popupCV" class="bg-black bg-opacity-25 text-white" style="display: none">
      <form id="formCV" class="">
        <h1>Upload CV</h1>

        <label for="fileUploadCV"><b>CV</b></label>
        <input type="file" name="fileUploadCV" value="fileUploadCV" id="fileUploadCV">

        <button type="submit" class="btn">Upload</button>
        <button type="button" class="btn cancel" onclick="fermerPopup(this)">Close</button>
      </form>

      <span id="messageErreurCV" class="mt-4 text-red-300 font-bold text-base text-center"></span>
    </div>

    <!-- POPUP CHANGEMENT DE LinkedIn -->
    <div id="popupLinkedIn" class="bg-black bg-opacity-25 text-white" style="display: none">
      <form id="formLinkedIn" class="">
        <h1>Associer LinkedIn</h1>

        <label for="textInputLinkedIn"><b>Lien Compte LinkedIn</b></label>
        <input type="text" name="textInputLinkedIn" value="" id="textInputLinkedIn">

        <button type="submit" class="btn">Modifier</button>
        <button type="button" class="btn cancel" onclick="fermerPopup(this)">Close</button>
      </form>

      <span id="messageErreurLinkedIn" class="mt-4 text-red-300 font-bold text-base text-center"></span>
    </div>

    <!-- <footer> -->
    <%- include('../partials/footer'); %>
      <!-- </footer> -->

      <script src="/static/js/compte.js"></script>
</body>

</html>